<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# profile: http://ogp.me/ns/profile#">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>A/B testing script with Google Tag Manager &middot; Simon Vreeman</title>
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    <link rel="prefetch" href="//www.google-analytics.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="//vreeman.com/css/style.css">
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/fontawesome/4.1.0/css/font-awesome.min.css">
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-NWPFGT');</script>
    <meta name="description" content="">
    <link rel="canonical" href="http://vreeman.com/a-b-testing-with-google-tag-manager/">
    <!--[if lt IE 9]>
      <script src="//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="//cdn.jsdelivr.net/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NWPFGT" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <figure id="topbar"></figure>
    <section class="container">
      <header class="page-header" role="banner">
        <h1>A/B testing script with Google Tag Manager</h1>
      </header>
      <section role="main">
        <p><em>Made by <a href="http://vreeman.com">Simon Vreeman</a>.</em></p>
        <p>It is a pretty simple script for <strong>A/B testing with <a href="https://www.google.com/tagmanager/" target="blank">Google Tag Manager</a></strong> and <a href="http://www.google.com/analytics/" target="blank">Google Analytics</a> for measuring and analysis. It uses the <a href="https://support.google.com/tagmanager/answer/2644341?hl=en#RandomNumber" target="blank">random macro</a> of Google Tag Manager, that returns a number between 0 and 2147483647. It is <a href="http://www.random.org/randomness/" target="blank">pseudo random</a>, but I run some tests and find that it is random enough for A/B testing.</p>
        <p>The biggest disadvantages of A/B testing with Google Tag Manager (not necessarily TMS in general) is that GTM loads the script asynchronous. That will cause a flicker effect on the webpage. The users can notice that something has changed and it is likely that they will behave different to it. Meaning that you will get mixed results.</p>
        <p>Other tag management systems have the option to load specific tags synchrone. With some small tweaks this script will work in other tag managers.</p>
        <h4>Google Analytics tracking</h4>
        <p>The script will send non-interaction events, custom dimensions and/or custom variables to the classic (ga.js) or universal (analytics.js) version Google Analytics. You can change that for your own needs. The custom variable is set for slot 5. When using the custom dimension, make sure you <a href="https://support.google.com/analytics/answer/2709829?hl=en" target="blank">configure it</a> in the Admin setting of your property. It is set for slot 20.</p>
        <h4>Google Tag Manager settings</h4>
        <p>Use the rules in Google Tag Manager to set where the test on the website should be running and how much of the traffic will be included. You can use the same random macro to set how much of the traffic should be in the test.</p>
        <p>When you do A/B testing you want to set a certain time of the test. You need enough users and conversions to get a good significance rate (95% or more). When creating the custom HTML tag in Google Tag Manager you can also set a custom tag firing schedule. That means you can set the dates when the test has to start and when it has to stop. You can find it under Advanced Settings, at the bottom of the page.</p>
        <p>The traffic is equal distributed among the two variations of the A/B test. But of course you have the possibility to change that for your own needs. <a href="http://dan-russell.com/2013/03/sampling-a-percentage-of-your-users-with-google-tag-manager/" target="blank">Dan Russell</a> explained that pretty well.</p>
        <p>Want to know and learn more about Google Tag Manager. Definitely take a look at the blog of <a href="http://www.simoahava.com" target="blank">Simo Ahava</a>.</p>
        <h3>Requirements</h3>
        <ul>
        <li>Google Tag Manager</li>
        </ul>
        <p>* <a href="#random">{{Random Number}} macro</a></p>
        <ul>
        <li>jQuery</li>
        <li><a href="https://github.com/carhartl/jquery-cookie" target="blank">jQuery Cookie by carhartl</a> - A minified version (1.4.1) is included in the script.</li>
        <li>Code can be at most 15,360 characters. Use an external .js file to load more code.</li>
        </ul>
        <h3 id="random">Create the {{Random Number}} macro in Google Tag Manager</h3>
        <p><em>To use the script, you need to create the Random Number macro.</em></p>
        <ol>
        <li>Click on the Read button New and select Macro.</li>
        <li>Give the macro the name <code>Random Number</code>.</li>
        <li>Select from the drop down Random Number.</li>
        <li>Save the macro.</li>
        </ol>
        <h3>How to use this script</h3>
        <ol>
        <li>Create a Custom HTML tag in your Google Tag Manager container.</li>
        <li>Past the code from <a href="testing.js">testing.js</a> to the tag. Make sure you use <code>&lt;script&gt;</code> and <code>&lt;/script&gt;</code> before and after.</li>
        <li>Set a unique <em>test id</em>.</li>
        <li>Set a unique <em>test name</em>.</li>
        <li>Create an optimization version.</li>
        <li>Set the rules for the test in Google Tag Manager.</li>
        <li>Test is with debug on. Set debug in the script to 1 and use the debug option in Google Tag Manager.</li>
        <li>Make sure the correct Google Analytics tracking is working.</li>
        <li>Turn the debug off.</li>
        <li>Create a new version and publish it.</li>
        </ol>
        <h2>Contact</h2>
        <ul>
        <li><a href="https://plus.google.com/+SimonVreeman?rel=author">Google+</a></li>
        <li><a href="https://twitter.com/vreeman">Twitter</a></li>
        <li><a href="mailto:simon@vreeman.com">Email</a></li>
        </ul>
        <h2>License</h2>
        <p>The MIT License (MIT)</p>
        <p>Copyright (c) 2014 Simon Vreeman</p>
        <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
        <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
        <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
      </section>
      <footer class="footer text-muted" role="contentinfo">
        <p><small><span class="pull-left">Enjoy your <span data-day></span>.</span> <span class="pull-right"><a class="text-muted" href="http://creativecommons.org/licenses/by/4.0/" title="Creative Commons Attribution 4.0 Unported License" target="_blank" rel="nofollow license" >License</a> & <a class="text-muted iubenda-nostyle no-brand iubenda-embed" href="//www.iubenda.com/privacy-policy/424323" title="Privacy Policy of vreeman.com" target="_blank" rel="nofollow">Privacy Policy</a> &middot; Hosted on <a class="text-muted" title="The source code of vreeman.com on Github" href="https://github.com/simonvreeman/simonvreeman.github.io" target="_blank" rel="nofollow">Github</a>.</span></small></p>
        <div id="time"></div>
      </footer>
    </section><!-- /container -->
    <script src="//cdn.jsdelivr.net/g/jquery,bootstrap"></script>
    <script src="//vreeman.com/js/main.js"></script>
    <script src="//cdn.iubenda.com/iubenda.js" async defer></script>
  </body>
</html>
